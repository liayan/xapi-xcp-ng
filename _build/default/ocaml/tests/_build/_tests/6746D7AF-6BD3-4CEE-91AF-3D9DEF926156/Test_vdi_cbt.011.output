[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'session'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'auth'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'subject'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'role'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'task'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'event'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'pool'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'pool_patch'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'pool_update'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VM'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VM_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VM_guest_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VMPP'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VMSS'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VM_appliance'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'DR_task'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'host'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'host_crashdump'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'host_patch'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'host_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'host_cpu'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'network'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VIF'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VIF_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PIF'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PIF_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Bond'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VLAN'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'SM'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'SR'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'sr_stat'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'probe_result'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'LVHD'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VDI'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VBD'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VBD_metrics'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PBD'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'crashdump'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VTPM'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'console'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'user'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'data_source'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'blob'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'message'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'secret'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'tunnel'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'network_sriov'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PCI'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PGPU'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'GPU_group'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VGPU'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VGPU_type'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PVS_site'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PVS_server'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PVS_proxy'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PVS_cache_storage'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Feature'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'SDN_controller'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'vdi_nbd_server_info'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'PUSB'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'USB_group'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'VUSB'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Cluster'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Cluster_host'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Certificate'
[20230915T14:36:35.668Z|debug||0 ||xapi] Adding new database table: 'Diagnostics'
[20230915T14:36:35.669Z| info||0 ||redo_log] Flushing database to all active redo-logs
[20230915T14:36:35.669Z|debug||0 ||xapi] About to flush database: ./xapi-db.xml
[20230915T14:36:35.669Z| info||0 ||redo_log] Flushing database to all active redo-logs
[20230915T14:36:35.670Z|debug||0 ||sql] XML backend [./xapi-db.xml] -- Write buffer flushed. Time: 0.001761
[20230915T14:36:35.670Z|error||0 ||dbsync] Cannot read IP address. Check the control interface has an IP address
[20230915T14:36:35.670Z|debug||0 ||db_write] create_row host_metrics (OpaqueRef:2ea039d3-707f-4709-8ab1-be98af86a7e8) [(_ref,v),(uuid,v),(memory__total,v),(memory__free,v),(live,v),(last_updated,v),(other_config,v)]
[20230915T14:36:35.670Z|debug||0 ||db_write] create_row host (OpaqueRef:d94b71b2-64e8-4718-867a-0ace0c3994c2) [(_ref,v),(uuid,v),(name__label,v),(name__description,v),(memory__overhead,v),(allowed_operations,v),(current_operations,v),(API_version__major,v),(API_version__minor,v),(API_version__vendor,v),(API_version__vendor_implementation,v),(enabled,v),(software_version,v),(other_config,v),(capabilities,v),(cpu_configuration,v),(sched_policy,v),(supported_bootloaders,v),(logging,v),(suspend_image_sr,v),(crash_dump_sr,v),(cpu_info,v),(hostname,v),(address,v),(metrics,v),(license_params,v),(boot_free_mem,v),(ha_statefiles,v),(ha_network_peers,v),(blobs,v),(tags,v),(external_auth_type,v),(external_auth_service_name,v),(external_auth_configuration,v),(edition,v),(license_server,v),(bios_strings,v),(power_on_mode,v),(power_on_config,v),(local_cache_sr,v),(chipset_info,v),(ssl_legacy,v),(guest_VCPUs_params,v),(display,v),(virtual_hardware_platform_versions,v),(control_domain,v),(updates_requiring_reboot,v),(iscsi_iqn,v),(multipathing,v),(uefi_certificates,v),(editions,v),(https_only,v)]
[20230915T14:36:35.671Z|error||0 ||helpers] Failed to find domain zero (uuid = b568ecde-50ed-4090-abc7-9692051655b0)
[20230915T14:36:35.671Z|debug||0 ||db_write] create_row VM (OpaqueRef:c47a0304-eb2a-493d-9a81-fb16bda8730a) [(_ref,v),(uuid,v),(allowed_operations,v),(current_operations,v),(name__label,v),(name__description,v),(power_state,v),(user_version,v),(is_a_template,v),(is_default_template,v),(suspend_VDI,v),(resident_on,v),(scheduled_to_be_resident_on,v),(affinity,v),(memory__overhead,v),(memory__target,v),(memory__static_max,v),(memory__dynamic_max,v),(memory__dynamic_min,v),(memory__static_min,v),(VCPUs__params,v),(VCPUs__max,v),(VCPUs__at_startup,v),(actions__after_shutdown,v),(actions__after_reboot,v),(actions__after_crash,v),(PV__bootloader,v),(PV__kernel,v),(PV__ramdisk,v),(PV__args,v),(PV__bootloader_args,v),(PV__legacy_args,v),(HVM__boot_policy,v),(HVM__boot_params,v),(HVM__shadow_multiplier,v),(platform,v),(PCI_bus,v),(other_config,v),(domid,v),(domarch,v),(last_boot_CPU_flags,v),(is_control_domain,v),(metrics,v),(guest_metrics,v),(last_booted_record,v),(recommendations,v),(xenstore_data,v),(ha_always_run,v),(ha_restart_priority,v),(is_a_snapshot,v),(snapshot_of,v),(snapshot_time,v),(transportable_snapshot_id,v),(blobs,v),(tags,v),(blocked_operations,v),(snapshot_info,v),(snapshot_metadata,v),(parent,v),(bios_strings,v),(protection_policy,v),(is_snapshot_from_vmpp,v),(snapshot_schedule,v),(is_vmss_snapshot,v),(appliance,v),(start_delay,v),(shutdown_delay,v),(order,v),(suspend_SR,v),(version,v),(generation_id,v),(hardware_platform_version,v),(has_vendor_device,v),(requires_reboot,v),(reference_label,v),(domain_type,v),(NVRAM,v)]
[20230915T14:36:35.671Z|debug||0 ||create_misc] Domain 0 record does not have associated metrics record. Creating now
[20230915T14:36:35.672Z|debug||0 ||db_write] create_row VM_metrics (OpaqueRef:b87f79df-6aec-411c-8637-c1f6c89a4300) [(_ref,v),(uuid,v),(memory__actual,v),(VCPUs__number,v),(VCPUs__utilisation,v),(VCPUs__CPU,v),(VCPUs__params,v),(VCPUs__flags,v),(state,v),(start_time,v),(install_time,v),(last_updated,v),(other_config,v),(hvm,v),(nested_virt,v),(nomigrate,v),(current_domain_type,v)]
[20230915T14:36:35.672Z|debug||0 ||db_write] create_row console (OpaqueRef:e4aa0ae1-5c3f-4974-b16f-0b50916194e0) [(_ref,v),(uuid,v),(protocol,v),(location,v),(VM,v),(other_config,v),(port,v)]
[20230915T14:36:35.672Z|debug||0 ||db_write] create_row console (OpaqueRef:5218a5d2-ed28-43a0-a665-ddcc172622a1) [(_ref,v),(uuid,v),(protocol,v),(location,v),(VM,v),(other_config,v),(port,v)]
[20230915T14:36:35.672Z|debug||0 ||create_misc] Updating Domain 0 metrics record
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row pool (OpaqueRef:d0ecbcc5-4c36-426a-8c1a-d2c4d24b664d) [(_ref,v),(uuid,v),(name_label,v),(name_description,v),(master,v),(default_SR,v),(suspend_image_SR,v),(crash_dump_SR,v),(other_config,v),(ha_enabled,v),(ha_configuration,v),(ha_statefiles,v),(ha_host_failures_to_tolerate,v),(ha_plan_exists_for,v),(ha_allow_overcommit,v),(ha_overcommitted,v),(blobs,v),(tags,v),(gui_config,v),(health_check_config,v),(wlb_url,v),(wlb_username,v),(wlb_password,v),(wlb_enabled,v),(wlb_verify_cert,v),(redo_log_enabled,v),(redo_log_vdi,v),(vswitch_controller,v),(restrictions,v),(ha_cluster_stack,v),(allowed_operations,v),(current_operations,v),(guest_agent_config,v),(cpu_info,v),(policy_no_vendor_device,v),(live_patching_disabled,v),(igmp_snooping_enabled,v),(uefi_certificates,v),(is_psr_pending,v)]
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row session (OpaqueRef:8bdb6f9c-52d3-4d11-8dd5-d9981e7dff6d) [(_ref,v),(uuid,v),(this_host,v),(this_user,v),(last_active,v),(pool,v),(other_config,v),(is_local_superuser,v),(subject,v),(validation_time,v),(auth_user_sid,v),(auth_user_name,v),(rbac_permissions,v),(parent,v),(originator,v)]
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row SM (OpaqueRef:64f8e15d-266b-4d30-960f-dc62c1bc67e9) [(_ref,v),(uuid,v),(name__label,v),(name__description,v),(type,v),(vendor,v),(copyright,v),(version,v),(required_api_version,v),(configuration,v),(capabilities,v),(features,v),(other_config,v),(driver_filename,v),(required_cluster_stack,v)]
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row SR (OpaqueRef:e4a90600-413f-46e4-a89d-31b17f3df738) [(_ref,v),(uuid,v),(name__label,v),(name__description,v),(allowed_operations,v),(current_operations,v),(virtual_allocation,v),(physical_utilisation,v),(physical_size,v),(type,v),(content_type,v),(shared,v),(other_config,v),(tags,v),(default_vdi_visibility,v),(sm_config,v),(blobs,v),(local_cache_enabled,v),(introduced_by,v),(clustered,v),(is_tools_sr,v)]
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row PBD (OpaqueRef:0d97289a-4f02-4150-8ef9-f054508bade8) [(_ref,v),(uuid,v),(host,v),(SR,v),(device_config,v),(currently_attached,v),(other_config,v)]
[20230915T14:36:35.673Z|debug||0 ||db_write] create_row VDI (OpaqueRef:933c3a7b-e6cb-43ea-baaa-d3f3562eac0e) [(_ref,v),(uuid,v),(name__label,v),(name__description,v),(allowed_operations,v),(current_operations,v),(SR,v),(virtual_size,v),(physical_utilisation,v),(type,v),(sharable,v),(read_only,v),(other_config,v),(storage_lock,v),(location,v),(managed,v),(missing,v),(parent,v),(xenstore_data,v),(sm_config,v),(is_a_snapshot,v),(snapshot_of,v),(snapshot_time,v),(tags,v),(allow_caching,v),(on_boot,v),(metadata_of_pool,v),(metadata_latest,v),(is_tools_iso,v),(cbt_enabled,v)]
[20230915T14:36:35.673Z|debug||0 ||mux] register SR 53a007fe-138d-472d-fc6c-0b7ca81f70a9 (currently-registered = [ e00c1eb9-6232-9c06-39bf-b9f0d262111e, 62dfdb93-ae45-1693-001e-e79165ec9f3f, 53a007fe-138d-472d-fc6c-0b7ca81f70a9, 4f36df36-77a8-d5ba-a0a1-f2a0558e2b36, 9cdd73d3-eded-9506-c86e-94f2393d6770, bad06e79-82bd-8bdd-4cce-865686b5d815 ])
[20230915T14:36:35.673Z|debug||0 ||xapi_vdi] wait_for_vbds_to_be_unplugged_and_destroyed: got event 19 vdi add OpaqueRef:933c3a7b-e6cb-43ea-baaa-d3f3562eac0e OK
[20230915T14:36:35.674Z|debug||0 ||xapi_vdi] wait_for_vbds_to_be_unplugged_and_destroyed: finished, VDI 4a2e1211-eeb5-80a3-d8b0-94152b9bce90 has 0 VBD(s)
[20230915T14:36:35.674Z| info||0 ||storage_impl] VDI.data_destroy dbg:DummyRef:|c4af3138-c995-4693-8e47-9bd78f5abe7a|session context sr:53a007fe-138d-472d-fc6c-0b7ca81f70a9 vdi:
[20230915T14:36:35.674Z|error||0 ||storage_interface] (Failure error) (File "storage/storage_interface.ml", line 439, characters 51-58)
[20230915T14:36:35.674Z|error||0 ||storage_interface] Storage_error ([S(Internal_error);S((Failure error))]) (File "storage/storage_interface.ml", line 431, characters 49-56)
[20230915T14:36:35.674Z|error||0 ||storage_interface] Storage_error ([S(Internal_error);S((Failure error))]) (File "storage/storage_interface.ml", line 436, characters 51-58)
[20230915T14:36:35.674Z|debug||0 ||storage_utils] Got failure: checking for redirect, call was: -> VDI.data_destroy({vdi:S();sr:S(53a007fe-138d-472d-fc6c-0b7ca81f70a9);dbg:S(DummyRef:|c4af3138-c995-4693-8e47-9bd78f5abe7a|session context)}), results.contents: ["Internal_error","(Failure error)"]
[20230915T14:36:35.674Z|debug||0 ||storage_utils] Not a redirect: -> VDI.data_destroy({vdi:S();sr:S(53a007fe-138d-472d-fc6c-0b7ca81f70a9);dbg:S(DummyRef:|c4af3138-c995-4693-8e47-9bd78f5abe7a|session context)})
[20230915T14:36:35.674Z|error||0 ||storage_interface] Storage_error ([S(Internal_error);S((Failure error))]) (File "storage/storage_interface.ml", line 431, characters 49-56)
[33m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------[0m
ASSERT data_destroy should not change the VDI's type to cbt_metadata when it did not succeed, it should preserve the original type
[33m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------[0m
